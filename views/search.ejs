<!DOCTYPE html><html lang="en"><head>...<link rel="stylesheet" href="/styles/search_style.css"></head><body>
<%- include('partials/header.ejs') %>

<div class="title">
  <%= len === 0 ? 'No Results Found.' : `${len} Results Found` %>
</div>
<div class="filter-buttons">
  <a href="/search-by-artist/<%= encodeURIComponent(query) %>">By Artist</a>
  <a href="/search-by-album/<%= encodeURIComponent(query) %>">By Album</a>
  <a href="/search-by-song/<%= encodeURIComponent(query) %>">By Song Name</a>
</div>

<div class="grid-container">
  <div class="grid-item">#</div><div class="grid-item">Song</div><div class="grid-item">Artist</div><div class="grid-item">Album</div><div class="grid-item">Duration</div><div class="grid-item">Actions</div>
  <% let i = 1; %>
  <% data.forEach((item, trackId) => { %>
    <div class="grid-item"><p><%= i++ %></p></div>
    <div class="grid-item"><p><%= item.song_name %></p></div>
    <div class="grid-item">
      <% item.artist.slice(0,2).forEach((a, idx) => { %>
        <a href="/artists/<%= encodeURIComponent(a) %>"><%= a %></a><%= idx === 0 && item.artist.length > 1 ? ', ' : '' %>
      <% }) %>
      <% if (item.artist.length > 2) { %><span>...</span><% } %>
    </div>
    <div class="grid-item"><p><%= item.album_name %></p></div>
    <div class="grid-item"><p><%= item.duration %></p></div>
    <div class="grid-item">
      <button class="add-button" data-track="<%= trackId %>" data-modal="modal-<%= i %>">Add</button>
      <a href="https://open.spotify.com/track/<%= trackId %>"><img src="spotify-icon.svg"></a>

      <div id="modal-<%= i %>" class="modal">
        <div class="modal-content">
          <span class="close">&times;</span>
          <form id="form-<%= i %>">
            <% playlists.forEach(pl => { %>
              <label>
                <input type="checkbox" name="playlist_id" value="<%= pl.playlist_id %>">
                <%= pl.playlist_name %>
              </label>
            <% }) %>
            <button type="submit">Add</button>
          </form>
        </div>
      </div>
    </div>
  <% }) %>
</div>

<%- include('partials/footer.ejs') %>
<script src="/js/playlist-modal.js"></script>
</body></html>
